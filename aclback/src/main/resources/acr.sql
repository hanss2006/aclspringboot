CREATE TABLE acl_sid (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    principal BOOLEAN NOT NULL,
    sid VARCHAR(100) NOT NULL,
    UNIQUE(sid, principal)
);
CREATE TABLE acl_class (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    class VARCHAR(255) NOT NULL,
    UNIQUE(class)
);
CREATE TABLE acl_object_identity (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    object_id_class BIGINT NOT NULL,
    object_id_identity BIGINT NOT NULL,
    parent_object BIGINT,
    owner_sid BIGINT,
    entries_inheriting BOOLEAN NOT NULL,
    FOREIGN KEY (object_id_class) REFERENCES acl_class(id),
    FOREIGN KEY (parent_object) REFERENCES acl_object_identity(id),
    FOREIGN KEY (owner_sid) REFERENCES acl_sid(id)
);
CREATE TABLE acl_entry (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    acl_object_identity BIGINT NOT NULL,
    ace_order INT NOT NULL,
    sid BIGINT NOT NULL,
    mask INTEGER NOT NULL,
    granting BOOLEAN NOT NULL,
    audit_success BOOLEAN NOT NULL,
    audit_failure BOOLEAN NOT NULL,
    FOREIGN KEY (acl_object_identity) REFERENCES acl_object_identity(id),
    FOREIGN KEY (sid) REFERENCES acl_sid(id)
);

INSERT INTO acl_class (id, class) VALUES
    (1, 'com.ocrv.skimrv.backend.dictionaries.entities.simple.OrgUnitDictionary');
INSERT INTO acl_class (id, class) VALUES
    (2, 'com.ocrv.skimrv.backend.dictionaries.entities.skim.DictRate');
INSERT INTO acl_class (id, class) VALUES
    (3, 'com.ocrv.skimrv.backend.dictionaries.entities.asfp.DictRateAsfp');

INSERT INTO ACL_SID (PRINCIPAL, SID) VALUES (false, 'ROLE_ADMIN');
INSERT INTO ACL_SID (PRINCIPAL, SID) VALUES (false, 'ROLE_USER');

INSERT INTO acl_object_identity (id, object_id_class, object_id_identity, parent_object, owner_sid, entries_inheriting) VALUES
    (1, 1, 1, NULL, 1, 0),
    (2, 1, 2, NULL, 1, 0),
    (3, 1, 3, NULL, 1, 0),
    (4, 1, 4, NULL, 1, 0),
    (5, 1, 5, NULL, 1, 0),

    (6, 2, 1, NULL, 1, 0),
    (7, 2, 2, NULL, 1, 0),
    (8, 2, 3, NULL, 1, 0),
    (9, 2, 4, NULL, 1, 0),
    (10, 2, 5, NULL, 1, 0),

    (11, 3, 1, NULL, 1, 0),
    (12, 3, 2, NULL, 1, 0),
    (13, 3, 3, NULL, 1, 0),
    (14, 3, 4, NULL, 1, 0),
    (15, 3, 5, NULL, 1, 0);
